符号化したデータの伝送③HDLC
===

## HDLCの概要

- オーバーヘッドが大きいため、低~中速度通信にとどまるベーシック手順に対して、
  *HDLC*は、高速通信を行うために標準化された伝送手順である。
  - HDLC: High-level Data Link Control procedure)
- フラグ同期を採用したことにより、任意のビット列の送信が可能。

### HDLCの仕様

|項目            |値                            |
|:--------------:|:----------------------------:|
|同期方式        |フラグ同期方式                |
|伝送単位        |フレーム単位                  |
|伝送データの内訳|任意のビット列                |
|誤り制御        |CRC                           |
|データリンク確立|3つの局概念                   |

---

## HDLCのフレーム構成

### アドレス部

- 以下のいずれかが挿入される
  - 受信局のアドレス(コマンドフレーム)
  - 送信局のアドレス(レスポンスフレーム)
- したがって、一次局⇔二次局通信では、必ず二次局のアドレスが設定される。

### 制御部

- コマンド/レスポンスの種類とフレーム番号が挿入される。

#### シーケンス番号

- 1フレームの順序を識別するために採番される番号
  - シーケンス番号により、データの順序制御と脱落制御を行う。
- P/Fビット
  - Pビットはコマンドフレームに挿入され、1を立てることで二次局からのレスポンスを促す(送信許可)
	- Fビットは、レスポンスフレームに挿入され、コマンドに対する応答であることを表す。

#### フレーム種別フィールド

- フレーム種別フィールドの内容により、フレームは*1フレーム*,*Sフレーム*,*Uフレーム*に区分される。

###### フレーム選別

- Iフレーム
  - ユーザデータを伝送するためのフレーム形式
	- コマンドとしてもレスポンスとしても利用できる。

- Sフレーム
  - 受信確認や再送要求など、データリンク管理に用いるフレームワーク形式
	- フレーム構成要素のうちIフィールドを持たない。
	- コマンドとしてもレスポンスとしても利用できる。

- Uフレーム
  - データリンクの確立と切断のために利用するフレームワーク形式
	- シーケンス番号を持たず、コマンドとレスポンスは区別される。

### 情報部

- ユーザデータが挿入される箇所、1フレームにのみ存在する。
- 一般的に、情報部は上位プロトコルのパケットがそのまま挿入されるフィールド

```
PDU = PCI + SDU
(N層のSDU) = (N+1層のPCI + SDU)
```

#### PDU

- Protocol Data Unit、OSI基本参照モデルの各層におけるデータの単位

#### SDU

- Service Data Unitの略。PDUにおいて透過的に伝送される部分。

#### PCI

- Protocol Control Informationの略。PDUにおいて通信制御に利用される部分。

### FCS(フレームチェックシーケンス)

- CRCによって誤り制御を行うための冗長情報が挿入されるフィールド
  - CRCによる誤り制御の対象となるのは、`A`,`C`,`I`の3つのフィールドである。
- フラグシーケンスである`0111110`やFCS自体はCRCの生成多項式に代入されないため。注意が必要である。
- 式によって、`A`,`C`,`I`のデータを除し、あまりをFCSとして送信する。
- 受信ノードはこのFCSを同じ生成多項式で除し、余りの有無で伝送データの正当性を判断する。
  - CRCはバースト誤りに対する検出性が高いのが特徴。

## HDLCの通信クラス

- HDLC手順では、モード設定コマンドによってデータリンクを確立し、コマンドとレスポンスからなる通信を行う。
- コマンドとレスポンスに挿入されるアドレスは、局の種類によって異なる。

### 不正均衡型手順クラス

- 一次局と、二次局によって行われる通信では、通信の主導権は必ず一次局が握る。
- したがって、どのネットワークにも一次局が1台存在しなければならない。
- ベーシック手順における制御局と従属局の関係である。
  - ただし、サブクラスによって正規応答クラスと、一次局からのコマンドがなくても二次局がレスポンスできる非同期応答クラスに分類できる。

### 平衡型手順クラス

- どのノードが通信を制御してもよい方式
  - この場合、コマンドには宛先ノードのアドレスが、レスポンスには送信元ノードのアドレスが挿入される。
- 複合局による通信と一次局⇔二次局通信は、混在することはできない。

