01.音声信号の符号化
===

## 概要

- 自然界に存在する情報はアナログの形で存在している。
- コンピュータはディジタル情報でないと処理することができない。
- アナログ情報をディジタル情報に変換する手法について学習を行う。

---

## アナログとディジタル

- アナログは*連続量*であるのに対して，ディジタルは`離散量`である。
  - ディジタルという語の語源はラテン語の指が語源であり，指を使って表すことのできる値という意味である。
- アナログ情報をディジタル情報に変換する場合は，細かい時間ごとにある瞬間の値を計測してデータとする。
- したがってアナログと比較した場合，*情報落ち*が発生する。
- 情報落ちは減少できるが0になることはない。
  - 所詮はまがい物，オリジナルには決して勝てない。

---

## ディジタル化のメリット

- オリジナルには勝てないディジタル情報を使用する理由は下記の通り

### ノイズに強い

- データの種類に関わらず，ネットワーク上でデータ伝送を行えば必ず何らかの干渉が入力されデータにノイズが混入する。
- アナログ信号からノイズのみを取り除いて原データを復元するのは困難だが，ディジタルデータは本質的に1か0で構成されているため，比較的復元が容易である。

### データ量のコントロールが可能

- 標本化，量子化の精度を変化させることで，データ量を制御することができる。

#### 標本化

- アナログ信号を単位時間ごとに区切る工程のこと
- *サンプリング*ともいう。
- 単位時間中のデータ変化の中央値や平均値によって標本値を決定する。
  - 単位時間を細かくすればデータの制度をあげられる。
	- 逆に大まかな間隔にすればデータの容量を制御できる。

#### 量子化

- 標本化によって得られた標本値を整数化する工程のこと。
- 整数化することで失われた情報を*量子化ノイズ*と呼ぶ。

#### 符号化

- 量子化した値をもとにディジタルデータを作成する。

### コンピュータシステムとの相性

- データに対して演算を行って成分超出や補正を行うなどの処理が可能になる。
- また，ディジタル化することでIP網を使った伝送が行えるようになり，ネットワークの基本的なインフラを統一して利用することができる。

|    |アナログデータ              |ディジタルデータ                |
|:--:|:--------------------------:|:------------------------------:|
|特徴|原データ                    |サンプリングによって得られた標本|
|長所|音声では自然な感じがする。  |ノイズに強い                    |
|    |                            |データに対して演算が行える。    |
|    |                            |サンプリング精度を変更することで|
|    |                            |データ量を調整できる。          |
|短所|伝送の時に弱い              |情報落ちが生じるため，サンプリン|
|    |加工が困難である。          |グ精度によっては，音声や画像が  |
|    |常に一定の帯域が要求される。|ぎくしゃくする。                |

---

## 標本化

- 標本化を行う周期のことを，*サンプリング周波数*という。
- サンプリング周波数を高くすると原データへの復元性が高まるが，データ容量は大きくなる。
- サンプリング周波数を低くすると，特に急激にデータが変化した個所(*高周波成分*)は復元できなくなり，データの精度が劣化する。
  - データ容量は小さくなる。
- 元のデータを復元するためには，データに含まれる一番高い周波数の2倍の周波数でサンプリングを行う必要がある。

### 試験での出方

- 本試験では，サンプリング周期を求めさせる形で，標本化理論が理解できているかを問うてくる。
- 例えば，「0 ~ 20kHzのオーディオ信号をディジタル信号に変換する場合，必要なサンプリング周期は？」というような問い
  - まず，2倍の周波数が必要という知識を用いて40kHzを導いた後，1秒間を40kで割り0.000025 = 25マイクロ秒を得る。

---

## 量子化

- 量子化は，サンプリングした成分によってデータの値を決定する。
- 原データの波形をどれだけの精度で区切って数値化するかを*量子化ビット数*によって決定する。
- 量子化ビット数が大きければ，切り上げ，切り下げの処理を行った際の誤差を小さくできる。
- 量子化ビット数が少ないと，この誤差は大きくなる。

---

## 符号化

- 標本化と量子化によって得られた数値をディジタルデータとして割り付ける工程が*符号化*である。
- 符号化には用途によって多くのアルゴリズムがある。

### 波形符号化

- 原データの波形を忠実に再現しようとする手法である。
- 復元品質は向上するがデータ量は大きくなる。
- 伝送経路をはじめとするシステム資源に余裕がある場合はこれを採用する。

#### PCM

- 原データを符号化する最も基本的な方式である。
- 標本化，量子化を行ったデータをそのまま符号に割り付ける。
  - PCMではデータを伝送する恩威必要な回線容量(ビットレート)を`サンプリング周波数と量子化ビット数の乗算`で求めることができる。
- 高いクオリティが要求される音楽CDで利用されていることを考慮すると，復元性の高いアルゴリズムであるといえる。

##### 例題

```
CDでは44.1kHzで標本化を行い，量子化ビット数は16ビットである。

44.1kHz × 16ビット = 705.6kビット/秒

から，CDに収められているデータをリアルタイムで伝送するためには，705.6kビットの回線容量が必要である。
```

#### ADCPM

- PCMに改良を加えてデータ容量を小さくした方式である。
- PCMでは量子化した値を絶対値として符号化していましたが，ADPCMは前データとの差分でこの値を表現している。
- 前のデータとの差が小さい場合は，絶対値で表すよりも少ない桁数でデータを表現できる。
- ビットレートを量子化ビット数の半分程度に抑えられる。
  - ただし，データに急激な変化が発生した場合は表現しきれずに大きなノイズが生じる。

### 分析合成符号化

- あらかじめいくつかのデータパターンを用意し，原データに最も近いものを選択する手法である。
- データ量を非常に小さく抑えられるが，復元品質は劣る。
  - 携帯電話など，通話帯域の小さい伝送路での利用が主流である。

#### 分析符号化

|符号化方式|解説|
|:--------:|:--------------------------------------------------:|
|LSR       |音声を低ビットレート伝送するための圧縮方式          |
|PARCOR    |音声を低ビットレート伝送するための圧縮方式          |
|LPC       |(Liner Prediction Coding), 線形予測符号化           |
|ADM       |(Adaptive Differential Modulation), 適応差分変調方式|
|ATC       |(Adaptive Transform Coding), 適応変換符号化         |
|APC       |(Adaptive Predictive Coding), 適応予測符号化        |
|APC-AB    |(Adaptive Predictive Coding with Adaptive Bit allocation)<br>適当ビット割り当て予測符号化|

### CELP

- 携帯電話用に開発された符号化方式で，量子化して得られそうなパターンをあらかじめデータベースに登録し，  
実際に量子化したデータと比較して最も近いものを選択する。
- 波形データではなくパターン番号のみを送信するため，データ量を最小化できる。
  - 原データを完全に再現することは不可能で，復元制度もPCMなどに比べて低くなる。
	- 狭帯域通信には向いているが，ネットワーク資源が潤沢であれば採用する意味はあまりない。
- パターン抽出処理には単純なPCMよりもCPUパワーが必要になる。

### CELPとPCM

#### CELP群(波形をパターン化しようとして伝えようとするグループ)

|略語    |フルスペル                                                  |説明|
|:------:|:----------------------------------------------------------:|:---------------------------------------------------------------------------------------------:|
|PSI-CELP|Pitch Synchronous Innovation-Code Exccited Linear Prediction|CELPの拡張方式で，小さいビットレートでCELPと同等の音声品質を目指した。|
|CS-ACELP|Conjugate Structure Algebraic Code Excited Linear Prediction|CELPの拡張方式で，メモリ上にデータパターンを展開する必要がないのが特徴。処理負荷を軽減できる。|
|VSELP   |Vector Sum Excited Linear Prediction                        |CELPの拡張方式で，ノイズに強く処理負荷が小さい特徴がある。音質はCELPに劣る。|

#### PCM群(波形をそのまま伝えようとするグループ)

|略語    |フルスペル                                           |説明|
|:------:|:---------------------------------------------------:|:------------------------------------------------------------:|
|DPCM    |Differentical Pulse Code Modulation                  |標本化の際に隣り合う標本の差分を量子化する方式。              |
|ADPCM   |Adaptive Differentical Pulse Code Modulation         |差が大きい個所を予測して追従性を高める，DPCMの改良仕様        |
|SB-ADPCM|Sub-Band Adaptive Differentical Pulse Code Modulation|音声符号化方式の一つで，広域と低域を分離して符号化するのが特徴|
