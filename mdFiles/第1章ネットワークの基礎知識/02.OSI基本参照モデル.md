02.OSI基本参照モデル
===

## 大きなプロトコルか小さなプロトコルか

- 大きな[プロトコル][1]を一つ作って終わりにするか，小さな[プロトコル][1]を組み合わせて使うかは  
それぞれに利点，欠点がある。
- 現時点では，異なるベンダの製品やサービスを組み合わせることが日常的に行われている。
  - 小さなプロトコルを組み合わせて使用する方法が多くなっている。

|                |利点                                    |欠点                                                      |
|:--------------:|:--------------------------------------:|:--------------------------------------------------------:|
|大きなプロトコル|通信の仕組み全体が1つの統一したルールに |手直しがしにくい。                                        |
|                |従うことになるためトラブルが生じにくい。|一部分だけ手直ししようとしても結局全体を見直すことになる。|
|小さなプロトコル|1つ1つは作るのが楽！                    |                                                          |
|                |新しいプロトコルを作成すればいいので    |プロトコル同士の組み合わせによっては動かなくなる。        |
|                |機能追加のコストが低くなる。            |                                                          |

[1]: 01.プロトコル.md

## 階層化

- 上記で，[_現時点では，異なるベンダの製品やサービスを組み合わせることが日常的に行われている。_]と記述したが，  
組み合わせる数が，2つなのか100なのかで違ってくる。
- 組み合わせの指針となる考え方が，*OSI基本参照モデル*である。
  - OSI基本参照モデルはISOによって定められた標準モデルである。
	- OSI基本参照モデルでは各プロトコルが実現する機能を7つのグループに分けて整理されている。
- 各グループはより，基本的な機能(下位)から，より応用的な機能(上位)へと上下関係がつけられている。
- 下位層は通信そのものを制御し，上位層は通信でやりとりされるデータの形などを規定する。

|      |階層 |層                |役割，機器  |
|:----:|:---:|:----------------:|:----------:|
|上位層|第7層|アプリケーション  |ゲートウェイ|
|      |第6層|プレゼンテーション|            |
|      |第5層|セション          |            |
|下位層|第4層|トランスポート    |            |
|      |第3層|ネットワーク      |ルータ      |
|      |第2層|データリンク      |ブリッジ    |
|      |第1層|物理層            |リピータ    |

## 7つの階層

- 同じ団体が作ったプロトコルはセットが使われることが多く，これらのセットを*プロトコルスイート*と呼ぶ。
- 情報技術者試験でよく問われるのは，IPを中心に囲まれた*`TCP/IPプロトコルスイート`*である。

### 下位層

#### 物理層

- 機器と機器を[*物理的につなぐ*]ことに関してルールを定める。
- 下記のようなことを定める。
  - ケーブルの口金の形
	- 電流の電気的な性質
	- 周波数

#### データリンク層

- [*[同じネットワーク内]にいる通信機器とのやりとり*]に関してルールを定める。
- `イーサネット`，`MACアドレス`がこの層に属している。

#### ネットワーク層

- [*[異なるネットワーク]とのやりとり*]に関してルールを定める。
- `IP`がこの層に属している。
  - IP以外にもネットワーク層のプロトコルはいろいろある。

#### トランスポート層

- [*データの品質管理*]に関してルールを定める。
- 下記のようなことを定める。
  - 伝送エラーの検出や再送
	- 送信データ量の調整
- 大事な役割として，[*どのソフトからどのソフトへ宛てた通信か*]を特定する。
  - トランスポート層のプロトコルは，ポート番号でこれを管理する。
- `TCP`, `UDP`などがこの層に属している。

---

### 上位層

#### セション層

- [*最終的な通信目的に合わせた送受信管理*]のルールを定める。
- 情報技術者試験ではあまり出題されない。
- 下記のようなことを定める。
  - コネクション確立やデータ転送のタイミング管理
	- 半二重通信 Or 全二重通信

#### プレゼンテーション層

- [*データの表現形式*]について取り決める。
- 電気的，物理的なデータ転送は下位層によって取り決められるが，プレゼンテーション層では下記のようなことを定める。
  - 送受信されたデータが圧縮されているか
	- 文字コードは何が使用されているか
- 上記のような内容をデータ送信の部分と切り離して定義することで，新しいデータ形式が現われても  
通信機器に影響を及ばさずに対応することができる。

##### アプリケーション層

- [*アプリケーションソフトがやり取りする情報*]について取り決める。
- `SMTP`，`HTTP`など，それぞれのアプリケーションに特化したプロトコルとなる。
- 最もユーザに近い部分を担当する。

---

## エンティティとサービス

- OSI基本参照モデルでは，それぞれの階層のことを*N層*と呼び。N層に存在する通信機器等の実体を*エンティティ*と呼ぶ。
- *N層に属するエンティティ同士が相互に通信を行うための取り決めが*プロトコルである。
- OSI基本参照モデルでは，上位に位置する層が下位に位置する層を利用しながら通信を行う。
  - 異なる階層間のエンティティ同士が通信する窓口(*インターフェース*)が必要になる。
	- OSI基本参照モデルでは下位層がこれを提供する。この機能ことを*サービス*と呼ぶ。

|用語            |説明                                              |
|:--------------:|:------------------------------------------------:|
|N層             |OSI基本参照モデルにおけるそれぞれの層。           |
|エンティティ    |それぞれの層に属する通信機器の実態。              |
|プロトコル      |エンティティ同士が通信を行うための取り決め。      |
|インターフェース|異なる階層のエンティティ同士が通信するための窓口。|
|サービス        |インタフェースを提供する機能。下位層が提供する。  |


---

## コネクション

- `N+1`層のエンティティは，ほかの`N+1`層のエンティティと通信を行うために，  
一つ下の階層である`N`層のサービスを利用する。
  - これを[`N`層のコネクションを利用した`N+1`層同士の通信]という。
